<!-- index.html -->
{% extends "layout.html" %}

{% block title %}Secret Santa - Home{% endblock %}

{% block content %}
<div class="container">
    <h1>Welcome to the Secret Santa Randomizer!</h1>
    <a href="{{ url_for('reveal') }}" class='button-participant'>Enter The Participants</a>
    <h2>Countdown
        <div id="timer"></div>
    </h2>
    <label for="revealDateInput" class='custom_label'>Enter Reveal Date and Time:</label>
    <input type="datetime-local" id="revealDateInput">
    <br>
    <br>
    <button onclick="setRevealDate()">Set Reveal Date</button>
    <br>
    <a href="{{ url_for('timer') }}" class='button-reveal'>Reveal The Super Secret List</a>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <ul>
        <li>Step 1: Enter the participants' names         </li>
        <li>Step 2: Enter each name separted by a comma   </li>
        <li>Example: Albert, Bobbi, Carl, Danny A, Fanny P</li>
        <li>Step 3: Click the calendar button next to "Set Reveal Date"</li>
        <li>Step 4: Click "Reveal The Super Secret List" and see what happens!</li>
        <li>Optional: Once the timer is up and you click 'Reveal Super Secret list', you can reset the list for a new group of people</li>
        <li>If you cannot see the option to reset your list, change the reveal date to the past </li>
    </ul>
    <h3>This program helps you organize a Secret Santa gift exchange!</h3>
</div>
<script>
    function setRevealDate() {
        // Get the value from the input field
        var inputDate = document.getElementById("revealDateInput").value;

        // Validate if a date is selected
        if (inputDate) {
            // Set the target date and time for the reveal in local storage
            localStorage.setItem("revealDate", inputDate);

            // Update the countdown every 1 second
            var timerInterval = setInterval(function() {
                var now = new Date().getTime();
                var distance = new Date(inputDate).getTime() - now;

                // Calculate days, hours, minutes, and seconds
                var days = Math.floor(distance / (1000 * 60 * 60 * 24));
                var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                var seconds = Math.floor((distance % (1000 * 60)) / 1000);

                // Display the countdown
                document.getElementById("timer").innerHTML =
                    days + "d " + hours + "h " + minutes + "m " + seconds + "s ";
                
                // Redirect to the reveal2 page when the countdown reaches zero
                if (distance <= 0) {
                    clearInterval(timerInterval);
                    window.location.replace("/reveal2");
                }
            }, 1000);
        } else {
            alert("Please select a reveal date and time.");
        }
    }
</script>

<div class="container">
    </ul>
</div>
{% endblock %}
