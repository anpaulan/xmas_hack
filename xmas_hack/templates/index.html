<!-- index.html -->
{% extends "layout.html" %}

{% block title %}Secret Santa - Home{% endblock %}

{% block content %}
<div class="container">
    <h1>Countdown</h1>
    <label for="revealDateInput">Enter Reveal Date and Time:</label>
    <input type="datetime-local" id="revealDateInput">
    <button onclick="setRevealDate()">Set Reveal Date</button>
    <div id="timer"></div>
</div>
<script>
    function setRevealDate() {
        // Get the value from the input field
        var inputDate = document.getElementById("revealDateInput").value;

        // Validate if a date is selected
        if (inputDate) {
            // Set the target date and time for the reveal in local storage
            localStorage.setItem("revealDate", inputDate);

            // Update the countdown every 1 second
            var timerInterval = setInterval(function() {
                var now = new Date().getTime();
                var distance = new Date(inputDate).getTime() - now;

                // Calculate days, hours, minutes, and seconds
                var days = Math.floor(distance / (1000 * 60 * 60 * 24));
                var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                var seconds = Math.floor((distance % (1000 * 60)) / 1000);

                // Display the countdown
                document.getElementById("timer").innerHTML =
                    days + "d " + hours + "h " + minutes + "m " + seconds + "s ";
                
                // Redirect to the reveal2 page when the countdown reaches zero
                if (distance <= 0) {
                    clearInterval(timerInterval);
                    window.location.replace("/reveal2");
                }
            }, 1000);
        } else {
            alert("Please select a reveal date and time.");
        }
    }
</script>

<div class="container">
    <h1>Welcome to the Secret Santa Randomizer!</h1>
    <p>This program helps you organize a Secret Santa gift exchange.</p>
    <br>
    <a href="{{ url_for('reveal') }}">Enter the participants</a>
    <br>
    <a href="{{ url_for('timer') }}">Timer</a>
</div>
{% endblock %}
